---
import type { RecipeIngredientJson } from "@/types";

interface Props {
  ingredients: RecipeIngredientJson[];
}

const { ingredients } = Astro.props;

const formatIngredientLine = (i: RecipeIngredientJson) => {
  const amount = i.amount !== undefined && i.amount !== null ? String(i.amount).trim() : "";
  const unit = i.unit ? String(i.unit).trim() : "";
  const item = i.item ? String(i.item).trim() : "";
  const prefix = [amount, unit].filter(Boolean).join(" ");
  return prefix ? `${prefix} ${item}`.trim() : item;
};
---

<section aria-labelledby="ingredients-title" class="rounded-xl border bg-card">
  <details open class="group">
    <summary
      class="flex cursor-pointer list-none items-center justify-between gap-3 px-4 py-3 md:hidden"
      aria-controls="ingredients-content"
    >
      <h2 id="ingredients-title" class="text-base font-medium">Ingredients</h2>
      <span class="text-sm text-muted-foreground group-open:hidden">Show</span>
      <span class="text-sm text-muted-foreground hidden group-open:inline">Hide</span>
    </summary>

    <div id="ingredients-content" class="px-4 pb-4 pt-2 md:pt-4">
      <h2 class="hidden md:block text-base font-medium mb-3">Ingredients</h2>

      {
        ingredients.length === 0 ? (
          <p class="text-sm text-muted-foreground">No ingredients to display.</p>
        ) : (
          <ul class="space-y-2">
            {ingredients.map((ing) => (
              <li class="text-sm leading-relaxed">
                <span class="mr-2 inline-block h-1.5 w-1.5 translate-y-[-1px] rounded-full bg-muted-foreground/40" />
                {formatIngredientLine(ing)}
              </li>
            ))}
          </ul>
        )
      }
    </div>
  </details>
</section>
